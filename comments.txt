Вопросы:

1. Надо ли изначально загрузить таблицу user_order_log или работаем только с новыми данными из user_order_log_inc? 

2. Как будто бы логичнее было бы править поле payment_amounts на отрицательное для заказов, которые вернули еще в загруженном файле csv,
нежели отдельную задачу ставить в даг. Тут я руководствовалась словами преподавателя, что сначала грузим, как есть, а потом меняем.

3. В задании есть вот такое предложение - "Благодаря витрине можно будет выяснить, какие категории товаров лучше всего удерживают клиентов."
Отсюда я сделала вывод, что важно за каждую неделю понимать сделать статистику по товарам. Поэтому группировка по item_id.
Ну и также не указано, в каком виде хотят видеть вот этот столбец - period_id — идентификатор периода (номер недели или номер месяца).
Поэтому, чтобы не запутаться он состоит из года и недели года.

Чтобы все работало корректно - сначала надо из файла migration запустить создание дополнительного столбца 
в staging.user_order_log и создание таблицы mart.f_customer_retention.



----
Из изменений:

1. Добавила колонки status и first_day_of_week в mart.f_sales, так как теперь использую эту таблицу для построения витрины mart.f_customer_retention.
2. Также вместо изменения payment_amount в таблице, которая лежит в staging слое, меняю в таблице mart.f_sales.
То есть подгружаю в нее данные за конкретный день и сразу меняю.
3. Чуть поменяла period_id. Раньше был составной period_id, сейчас просто подгружаю первый день недели (first_day_of_week) из mart.f_sales.
Так неделя тоже определяется однозначно, а код выглядит проще.
4. По поводу инкрементального обновления - так как нам нет необходимости хранить даты, в которые данные менялись, то обновление реализовала
чуть проще - каждый день удаляю данные за эту неделю и обновляю цифры. Остальные строки остаются нетронутыми) 
это считается за инкрементальное обновление? или же нужно делать именно через доп таблицу, в которой указаны все даты последнего обновления таблиц?